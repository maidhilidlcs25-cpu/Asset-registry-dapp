<!DOCTYPE html>
<html>
<head>
    <title>Asset Registry DApp</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f2f2f2;
        }
        .container {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            width: 420px;
            margin-bottom: 20px;
            box-shadow: 0 0 10px #ccc;
        }
        input, button {
            margin: 6px 0;
            width: 100%;
            padding: 10px;
        }
        button {
            background: #4CAF50;
            border: none;
            color: white;
            cursor: pointer;
        }
    </style>
</head>

<body>

<h1>Asset Registry DApp</h1>

<button onclick="connectWallet()">Connect Wallet</button>
<p id="walletAddress"></p>

<div class="container">
    <h3>Register Asset</h3>
    <input type="text" id="regAssetId" placeholder="Asset ID">
    <input type="text" id="regAssetName" placeholder="Asset Name">
    <input type="text" id="regDescription" placeholder="Description">
    <button onclick="registerAsset()">Register Asset</button>
</div>

<div class="container">
    <h3>View Asset Details</h3>
    <input type="text" id="viewAssetId" placeholder="Asset ID">
    <button onclick="viewAsset()">View Asset</button>
    <p id="assetDetails"></p>
</div>

<div class="container">
    <h3>Transfer Ownership</h3>
    <input type="text" id="transferAssetId" placeholder="Asset ID">
    <input type="text" id="newOwner" placeholder="New Owner Wallet Address">
    <button onclick="transferOwnership()">Transfer</button>
</div>

<script>
    const contractAddress = "0x694d741E7FAFdb7517487D27931B4964Bd61095E";

    const abi = 
    [
	{
		"anonymous": false,
		"inputs": [
			{"indexed": false,"internalType": "string","name": "assetId","type": "string"},
			{"indexed": false,"internalType": "string","name": "assetName","type": "string"},
			{"indexed": false,"internalType": "string","name": "description","type": "string"},
			{"indexed": false,"internalType": "address","name": "owner","type": "address"}
		],
		"name": "AssetRegistered",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{"indexed": false,"internalType": "string","name": "assetId","type": "string"},
			{"indexed": false,"internalType": "address","name": "from","type": "address"},
			{"indexed": false,"internalType": "address","name": "to","type": "address"}
		],
		"name": "OwnershipTransferred",
		"type": "event"
	},
	{
		"inputs": [
			{"internalType": "string","name": "_assetId","type": "string"},
			{"internalType": "string","name": "_assetName","type": "string"},
			{"internalType": "string","name": "_description","type": "string"}
		],
		"name": "registerAsset",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{"internalType": "string","name": "_assetId","type": "string"},
			{"internalType": "address","name": "newOwner","type": "address"}
		],
		"name": "transferAsset",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [{"internalType": "string","name": "","type": "string"}],
		"name": "assets",
		"outputs": [
			{"internalType": "string","name": "assetId","type": "string"},
			{"internalType": "string","name": "assetName","type": "string"},
			{"internalType": "string","name": "description","type": "string"},
			{"internalType": "address","name": "owner","type": "address"}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [{"internalType": "string","name": "_assetId","type": "string"}],
		"name": "getAsset",
		"outputs": [
			{"internalType": "string","name": "","type": "string"},
			{"internalType": "string","name": "","type": "string"},
			{"internalType": "string","name": "","type": "string"},
			{"internalType": "address","name": "","type": "address"}
		],
		"stateMutability": "view",
		"type": "function"
	}
];

    let provider, signer, contract;

    async function connectWallet() {
        if (window.ethereum) {
            provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            signer = provider.getSigner();
            contract = new ethers.Contract(contractAddress, abi, signer);

            const address = await signer.getAddress();
            document.getElementById("walletAddress").innerText = "Connected: " + address;
        } else {
            alert("MetaMask not installed!");
        }
    }

    async function registerAsset() {
        const id = document.getElementById("regAssetId").value;
        const name = document.getElementById("regAssetName").value;
        const desc = document.getElementById("regDescription").value;

        try {
            const tx = await contract.registerAsset(id, name, desc);
            await tx.wait();
            alert("Asset Registered Successfully!");
        } catch (err) {
            alert("Error: " + err.message);
        }
    }

    async function viewAsset() {
        const id = document.getElementById("viewAssetId").value;
        try {
            const data = await contract.getAsset(id);

            document.getElementById("assetDetails").innerHTML =
                "<b>Asset ID:</b> " + data[0] + "<br>" +
                "<b>Asset Name:</b> " + data[1] + "<br>" +
                "<b>Description:</b> " + data[2] + "<br>" +
                "<b>Owner:</b> " + data[3];
        } catch (err) {
            alert("Error: " + err.message);
        }
    }

    async function transferOwnership() {
        const id = document.getElementById("transferAssetId").value;
        const newOwner = document.getElementById("newOwner").value;

        try {
            const tx = await contract.transferAsset(id, newOwner);
            await tx.wait();
            alert("Ownership Transferred!");
        } catch (err) {
            alert("Error: " + err.message);
        }
    }
</script>
src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.6.1/ethers.umd.min.js"></script> <script src="script.js"></script>
</body>
</html>

